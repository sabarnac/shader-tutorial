"use strict";(self.webpackChunkshader_tutorial=self.webpackChunkshader_tutorial||[]).push([[90],{2114:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var n=a(4794),i=a(2532),r=a(6540),o=(a(6449),a(3514),a(7684)),s=a(3461),c=a(6417),d=a(782),l="attribute vec4 vertexPosition;\n\nvoid main() {\n  gl_Position = vertexPosition;\n}";const h=l,g="uniform highp vec2 resolution;\n\nvoid main() {\n  highp vec2 coordinates = gl_FragCoord.xy / resolution;\n\n  highp float fragmentColor = mix(0.05, 0.35, 1.0 - coordinates.y);\n  gl_FragColor = vec4(vec3(fragmentColor), 1.0);\n}",u={vertex:{attributeLocations:{vertexPosition:"vec4"},uniformLocations:{}},fragment:{attributeLocations:{},uniformLocations:{resolution:"vec2"}}},m=o.vt();var f=(0,c.A)((()=>{const e={vertices:[[-1,-1,0],[-1,1,0],[1,-1,0],[1,1,0]]},{0:t,1:a}=(0,r.useState)(null),{0:n,1:i}=(0,r.useState)(null),{0:o,1:c}=(0,r.useState)(null),{0:l,1:f}=(0,r.useState)({vertices:null}),b=(0,r.useRef)();return(0,r.useEffect)((()=>{if(null!==b.current){const e=new d.A(b.current,m);return a(e),()=>{a(null),e.destroy()}}}),[b]),(0,r.useEffect)((0,s.sT)(null!==t,(()=>{i(t.createShaderProgram(h,g))})),[t]),(0,r.useEffect)((0,s.sT)(null!==n,(()=>{c(t.getDataLocations(n,u))})),[n]),(0,r.useEffect)((0,s.sT)(null!==o,(()=>{f({vertices:t.createStaticDrawArrayBuffer(e.vertices.flat(),l.vertices)})})),[o]),(0,r.useEffect)((0,s.sT)(null!==l.vertices,(()=>{let a=!0;const i=()=>{t.renderScene((t=>{let{gl:r,resolution:s}=t;a&&(r.bindBuffer(r.ARRAY_BUFFER,l.vertices),r.vertexAttribPointer(o.vertex.attributeLocations.vertexPosition,3,r.FLOAT,!1,0,0),r.enableVertexAttribArray(o.vertex.attributeLocations.vertexPosition),r.useProgram(n),r.uniform2fv(o.fragment.uniformLocations.resolution,s),r.drawArrays(r.TRIANGLE_STRIP,0,e.vertices.length),requestAnimationFrame(i))}))};return requestAnimationFrame(i),()=>{a=!1}})),[l]),r.createElement("div",{className:"util text-center",style:{padding:"1rem"}},r.createElement("canvas",{width:"640",height:"480",ref:b},"Cannot run WebGL examples (not supported)"))}));const b=l,p="uniform highp vec2 resolution;\n\nconst highp float NOISE_GRANULARITY = 0.5/255.0;\n\nhighp float random(highp vec2 coords) {\n   return fract(sin(dot(coords.xy, vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\n  highp vec2 coordinates = gl_FragCoord.xy / resolution;\n\n  highp float fragmentColor = mix(0.05, 0.35, 1.0 - coordinates.y);\n  fragmentColor += mix(-NOISE_GRANULARITY, NOISE_GRANULARITY, random(coordinates));\n  gl_FragColor = vec4(vec3(fragmentColor), 1.0);\n}",w={vertex:{attributeLocations:{vertexPosition:"vec4"},uniformLocations:{}},fragment:{attributeLocations:{},uniformLocations:{resolution:"vec2"}}},v=o.vt();var x=(0,c.A)((()=>{const e={vertices:[[-1,-1,0],[-1,1,0],[1,-1,0],[1,1,0]]},{0:t,1:a}=(0,r.useState)(null),{0:n,1:i}=(0,r.useState)(null),{0:o,1:c}=(0,r.useState)(null),{0:l,1:h}=(0,r.useState)({vertices:null}),g=(0,r.useRef)();return(0,r.useEffect)((()=>{if(null!==g.current){const e=new d.A(g.current,v);return a(e),()=>{a(null),e.destroy()}}}),[g]),(0,r.useEffect)((0,s.sT)(null!==t,(()=>{i(t.createShaderProgram(b,p))})),[t]),(0,r.useEffect)((0,s.sT)(null!==n,(()=>{c(t.getDataLocations(n,w))})),[n]),(0,r.useEffect)((0,s.sT)(null!==o,(()=>{h({vertices:t.createStaticDrawArrayBuffer(e.vertices.flat(),l.vertices)})})),[o]),(0,r.useEffect)((0,s.sT)(null!==l.vertices,(()=>{let a=!0;const i=()=>{t.renderScene((t=>{let{gl:r,resolution:s}=t;a&&(r.bindBuffer(r.ARRAY_BUFFER,l.vertices),r.vertexAttribPointer(o.vertex.attributeLocations.vertexPosition,3,r.FLOAT,!1,0,0),r.enableVertexAttribArray(o.vertex.attributeLocations.vertexPosition),r.useProgram(n),r.uniform2fv(o.fragment.uniformLocations.resolution,s),r.drawArrays(r.TRIANGLE_STRIP,0,e.vertices.length),requestAnimationFrame(i))}))};return requestAnimationFrame(i),()=>{a=!1}})),[l]),r.createElement("div",{className:"util text-center",style:{padding:"1rem"}},r.createElement("canvas",{width:"640",height:"480",ref:g},"Cannot run WebGL examples (not supported)"),r.createElement("pre",{className:"util text-left"},"Noise Granularity: 0.5 / 255.0"))})),y=a(9460),E=a(7154),S=a(6042),A=a(7570),k=a(2007),T=a(2269);var _=e=>{let{location:{pathname:t}}=e;return r.createElement(A.A,null,r.createElement(T.A,{pathname:t,title:"Shader Advanced - Color Banding and Dithering",description:"A look into what color banding is and how to mitigate it using dithering.",keywords:["shader","advanced","banding","dithering"]}),r.createElement(y.A,null,r.createElement("h1",null,"Shader Advanced - Color Banding and Dithering"),r.createElement("p",null,"An issue that can occur when drawing gradients is something called color banding. Let us look at a flat grayscale gradient going from black to white."),r.createElement(S.A,{type:"h3"},"Example - Color Banded Gradient"),r.createElement(f,null),r.createElement(E.A,{code:g,type:"Fragment"}),r.createElement("p",null,"The issue may not be very obvious at first, so here's a screenshot of a portion of the image."),r.createElement("div",{className:"image util text-center"},r.createElement(i.S,{src:"../../images/advanced/banded.png",alt:"Color Banding Screenshot Normal",style:{maxWidth:"65%"},__imageData:a(7105)})),r.createElement("p",null,"We can modify the light levels to make the issue more obvious."),r.createElement("div",{className:"image util text-center"},r.createElement(i.S,{src:"../../images/advanced/banded-exaggerated.png",alt:"Color Banding Screenshot Exaggerated",style:{maxWidth:"65%"},__imageData:a(9651)})),r.createElement("p",null,"It appears that the image has bands of colors going across it. This shouldn't occur since the decrease of light from the bottom to the top should be gradual and smooth."),r.createElement("p",null,'This issue is called color banding, and it is a problem because it makes a gradient of colors appear to be "chunky" rather than smooth, which is generally an undesirable effect.'),r.createElement("p",null,"We've previously discussed in the"," ",r.createElement(n.Link,{to:"/advanced/color-2/"},"color part 2 chapter")," that computers are limited in what colors they have the ability to represent and show."),r.createElement("p",null,"This issue occurs mainly because the colors that are required to show the colors transitioning smoothly just do not exist among the range of colors that can form an image and a monitor can show."),r.createElement("p",null,"This means that if a computer wished to show a gradient of colors, there will be bands of colors forming instead of a smooth transition, since a computer cannot show the colors in between the two bands."),r.createElement("p",null,"This issue can be illustrated in a simple way. Suppose we could only represent colors using a 1-bit value. This would mean a computer could only show two colors, black and white."),r.createElement("div",{className:"image util text-center"},r.createElement(i.S,{src:"../../images/advanced/actual-gradient.png",alt:"Actual Gradient",style:{maxWidth:"65%"},__imageData:a(9210)}),r.createElement("br",null),r.createElement("a",{href:"https://www.xmple.com/wallpaper/black-white-gradient-linear--c2-000000-fffaf0-a-180-f-14-image/",target:"_blank",rel:"noopener noreferrer"},"Source")),r.createElement("p",null,"Now, suppose the computer had to render a gradient of colors, going from white to black, as shown in the image above. Since the computer can only show black and white, all the shades of gray in between cannot be displayed by the computer."),r.createElement("div",{className:"image util text-center"},r.createElement(i.S,{src:"../../images/advanced/banded-gradient.png",alt:"Banded Gradient",style:{maxWidth:"65%"},__imageData:a(3539)})),r.createElement("p",null,"This results in the computer showing a continues band of white, with a sudden transition to a band of black. This is a case of color banding, albeit an extreme one."),r.createElement(S.A,{type:"h2"},"Dithering"),r.createElement("p",null,"The solution to this issue of not being able to represent intermediate colors is called dithering. The"," ",r.createElement("a",{href:"https://en.wikipedia.org/wiki/Dither",target:"_blank",rel:"noopener noreferrer"},"Wikipedia article on dithering"),", as well as the YouTube video by"," ",r.createElement("a",{href:"https://www.youtube.com/channel/UC9-y-6csu5WGm29I7JiwpnA",target:"_blank",rel:"noopener noreferrer"},"Computerphile")," ","on"," ",r.createElement("a",{href:"https://youtu.be/IviNO7iICTM",target:"_blank",rel:"noopener noreferrer"},"ordered dithering")," ","provide good explanations on what dithering is, but we'll also discuss it here."),r.createElement("p",null,"Dithering is the process of introducing noise into an image. By introducing this noise in a certain way, you can overcome the limitations of the detail that can be shown by the computer and screen."),r.createElement("p",null,"Below is an example showing how introducing noise can improve the detail of an image:"),r.createElement("div",{className:"util text-center"},r.createElement(i.S,{src:"../../images/advanced/dithering-example.png",alt:"Wikipedia Dithering Example",style:{maxWidth:"65%"},__imageData:a(661)}),r.createElement("br",null),r.createElement("a",{href:"https://commons.wikimedia.org/wiki/File:Michelangelo%27s_David_-_Floyd-Steinberg.png",target:"_blank",rel:"noopener noreferrer"},"Source")),r.createElement("p",null,"The image is just made from white and black pixels, but through the introduction of noise into the image, shades of gray can be seen within the image, although there is no actual gray present."),r.createElement("p",null,"This is due to how colors interact with each other and affect how they appear to us, as discussed in the"," ",r.createElement(n.Link,{to:"/advanced/color-2/"},"color part 2 chapter"),". This interactions blends the noise of the colors together to appear as one smooth band."),r.createElement("p",null,"The noise does introduce a grainy effect, but the added detail in color is a high benefit, and in multiple cases this added detail offsets the issue of grain in the image."),r.createElement("p",null,"The noise can be a lot harder to spot in certain issues where colors that form bands are a lot closer to each other in the color spectrum, like in our example of color banding above."),r.createElement("p",null,"If we apply a noise to our image, it should cause dithering and allow for the colors to blend together."),r.createElement("p",null,"Since the colors forming the bands are already pretty close in the color spectrum, the grainy effect introduced by dithering should be very hard to spot, making it ideal to fix the banding issue."),r.createElement(S.A,{type:"h3"},"Example - Dithered Gradient"),r.createElement(x,null),r.createElement("p",null,"Below is a zoomed in part of the new dithered image."),r.createElement("div",{className:"util text-center"},r.createElement(i.S,{src:"../../images/advanced/noised.png",alt:"Dithering Screenshot Normal",style:{maxWidth:"65%"},__imageData:a(8493)})),r.createElement("p",null,"We can modify the light levels to see the introduced noise."),r.createElement("div",{className:"util text-center"},r.createElement(i.S,{src:"../../images/advanced/noised-exaggerated.png",alt:"Dithering Screenshot Exaggerated",style:{maxWidth:"65%"},__imageData:a(3340)})),r.createElement("p",null,"While with the color banding screenshots, the banding was noticeable even in the non-altered image (unless your display isn't calibrated well), with the dithered original screenshot there is no appearance of banding or even noise in the image."),r.createElement("p",null,"The noise is only visible when modifying the light levels, but since the randomness spreads the colors of the bands, they easily blend together and look smooth to your eyes."),r.createElement(E.A,{code:p,type:"Fragment"}),r.createElement("p",null,"A random number is generated for the fragment which needs to be noised. The granularity for the noise (stored in the constant"," ",r.createElement("code",null,"NOISE_GRANULARITY"),") is set to a very small number (",r.createElement("code",null,"0.5/255.0"),") to ensure that any shift in color due to the noise would be minimal."),r.createElement("p",null,"A random value was linearly interpolated using the GLSL function"," ",r.createElement("code",null,"mix")," within this noise granularity range using the generated random number for the fragment and added to the fragment color, resulting in the color of the fragment being slightly modified."),r.createElement("p",null,"Since the shift in color is random for every fragment, it results in in unordered/random dithering due to the randomness of the generated noise."),r.createElement("p",null,"This process removes the appearence of color banding, as seen in the dithering screenshots, and allows for color gradients to appear much smoother than they really are."),r.createElement("p",null,"To learn more about dithering in general and various dithering techniques out there, check out the"," ",r.createElement("a",{href:"https://youtu.be/wS0Gck00nDw",target:"_blank",rel:"noopener noreferrer"},"HTTP 203 episode discussing it"),"."),r.createElement(S.A,{type:"h2"},"Summary"),r.createElement("ul",null,r.createElement("li",null,"Color banding is an issue that can occur when the computer cannot simulate a transition between two colors since it cannot represent the intermediate colors between the two."),r.createElement("li",null,"Dithering is a process of adding noise to an image to remove color pattern issues such as color banding. Dithering is of two types - ordered dithering, and unordered dithering."))),r.createElement(k.A,{previous:"/advanced/branching/",next:"/advanced/transparency/"}))}},8493:function(e){e.exports=JSON.parse('{"layout":"constrained","backgroundColor":"#282828","images":{"fallback":{"src":"/static/f450f2afe1123bf38d1343548c451cd1/89ddb/noised.png","srcSet":"/static/f450f2afe1123bf38d1343548c451cd1/f93df/noised.png 187w,\\n/static/f450f2afe1123bf38d1343548c451cd1/310b0/noised.png 374w,\\n/static/f450f2afe1123bf38d1343548c451cd1/89ddb/noised.png 747w","sizes":"(min-width: 747px) 747px, 100vw"},"sources":[{"srcSet":"/static/f450f2afe1123bf38d1343548c451cd1/ee704/noised.webp 187w,\\n/static/f450f2afe1123bf38d1343548c451cd1/6a1d5/noised.webp 374w,\\n/static/f450f2afe1123bf38d1343548c451cd1/e8ca8/noised.webp 747w","type":"image/webp","sizes":"(min-width: 747px) 747px, 100vw"}]},"width":747,"height":750}')},9210:function(e){e.exports=JSON.parse('{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/7398ae88a4db2c10eaacd734e10dd7e7/7c471/actual-gradient.png","srcSet":"/static/7398ae88a4db2c10eaacd734e10dd7e7/4715e/actual-gradient.png 200w,\\n/static/7398ae88a4db2c10eaacd734e10dd7e7/3b96c/actual-gradient.png 400w,\\n/static/7398ae88a4db2c10eaacd734e10dd7e7/7c471/actual-gradient.png 800w","sizes":"(min-width: 800px) 800px, 100vw"},"sources":[{"srcSet":"/static/7398ae88a4db2c10eaacd734e10dd7e7/f42d9/actual-gradient.webp 200w,\\n/static/7398ae88a4db2c10eaacd734e10dd7e7/1e622/actual-gradient.webp 400w,\\n/static/7398ae88a4db2c10eaacd734e10dd7e7/53c1e/actual-gradient.webp 800w","type":"image/webp","sizes":"(min-width: 800px) 800px, 100vw"}]},"width":800,"height":480}')},3539:function(e){e.exports=JSON.parse('{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/0977f80953cdeb0f92992ac4e2feef3f/7c471/banded-gradient.png","srcSet":"/static/0977f80953cdeb0f92992ac4e2feef3f/4715e/banded-gradient.png 200w,\\n/static/0977f80953cdeb0f92992ac4e2feef3f/3b96c/banded-gradient.png 400w,\\n/static/0977f80953cdeb0f92992ac4e2feef3f/7c471/banded-gradient.png 800w","sizes":"(min-width: 800px) 800px, 100vw"},"sources":[{"srcSet":"/static/0977f80953cdeb0f92992ac4e2feef3f/f42d9/banded-gradient.webp 200w,\\n/static/0977f80953cdeb0f92992ac4e2feef3f/1e622/banded-gradient.webp 400w,\\n/static/0977f80953cdeb0f92992ac4e2feef3f/53c1e/banded-gradient.webp 800w","type":"image/webp","sizes":"(min-width: 800px) 800px, 100vw"}]},"width":800,"height":480}')},7105:function(e){e.exports=JSON.parse('{"layout":"constrained","backgroundColor":"#282828","images":{"fallback":{"src":"/static/400273b5b9d7e1badf9d8ec4061e69bb/8d33e/banded.png","srcSet":"/static/400273b5b9d7e1badf9d8ec4061e69bb/41cc8/banded.png 175w,\\n/static/400273b5b9d7e1badf9d8ec4061e69bb/88e48/banded.png 350w,\\n/static/400273b5b9d7e1badf9d8ec4061e69bb/8d33e/banded.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/400273b5b9d7e1badf9d8ec4061e69bb/51bad/banded.webp 175w,\\n/static/400273b5b9d7e1badf9d8ec4061e69bb/6cac9/banded.webp 350w,\\n/static/400273b5b9d7e1badf9d8ec4061e69bb/ec00d/banded.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":700,"height":700}')},3340:function(e){e.exports=JSON.parse('{"layout":"constrained","backgroundColor":"#383838","images":{"fallback":{"src":"/static/71b84e6cc946ee2faaeaef4fd0b1a480/89ddb/noised-exaggerated.png","srcSet":"/static/71b84e6cc946ee2faaeaef4fd0b1a480/f93df/noised-exaggerated.png 187w,\\n/static/71b84e6cc946ee2faaeaef4fd0b1a480/310b0/noised-exaggerated.png 374w,\\n/static/71b84e6cc946ee2faaeaef4fd0b1a480/89ddb/noised-exaggerated.png 747w","sizes":"(min-width: 747px) 747px, 100vw"},"sources":[{"srcSet":"/static/71b84e6cc946ee2faaeaef4fd0b1a480/ee704/noised-exaggerated.webp 187w,\\n/static/71b84e6cc946ee2faaeaef4fd0b1a480/6a1d5/noised-exaggerated.webp 374w,\\n/static/71b84e6cc946ee2faaeaef4fd0b1a480/e8ca8/noised-exaggerated.webp 747w","type":"image/webp","sizes":"(min-width: 747px) 747px, 100vw"}]},"width":747,"height":750}')},661:function(e){e.exports=JSON.parse('{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/add933a89a9344499410f1926b3f3a1d/173d6/dithering-example.png","srcSet":"/static/add933a89a9344499410f1926b3f3a1d/0955c/dithering-example.png 45w,\\n/static/add933a89a9344499410f1926b3f3a1d/705f1/dithering-example.png 90w,\\n/static/add933a89a9344499410f1926b3f3a1d/173d6/dithering-example.png 180w","sizes":"(min-width: 180px) 180px, 100vw"},"sources":[{"srcSet":"/static/add933a89a9344499410f1926b3f3a1d/8eb70/dithering-example.webp 45w,\\n/static/add933a89a9344499410f1926b3f3a1d/30edb/dithering-example.webp 90w,\\n/static/add933a89a9344499410f1926b3f3a1d/7741c/dithering-example.webp 180w","type":"image/webp","sizes":"(min-width: 180px) 180px, 100vw"}]},"width":180,"height":215}')},9651:function(e){e.exports=JSON.parse('{"layout":"constrained","backgroundColor":"#585858","images":{"fallback":{"src":"/static/a35eb562a3ac109ea1f9efcb50431401/8d33e/banded-exaggerated.png","srcSet":"/static/a35eb562a3ac109ea1f9efcb50431401/41cc8/banded-exaggerated.png 175w,\\n/static/a35eb562a3ac109ea1f9efcb50431401/88e48/banded-exaggerated.png 350w,\\n/static/a35eb562a3ac109ea1f9efcb50431401/8d33e/banded-exaggerated.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/a35eb562a3ac109ea1f9efcb50431401/51bad/banded-exaggerated.webp 175w,\\n/static/a35eb562a3ac109ea1f9efcb50431401/6cac9/banded-exaggerated.webp 350w,\\n/static/a35eb562a3ac109ea1f9efcb50431401/ec00d/banded-exaggerated.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":700,"height":700}')}}]);
//# sourceMappingURL=component---src-pages-advanced-color-banding-dithering-js-d7c3d60724228fa601b3.js.map